<mat-toolbar color="accent">Race to {{ game.pointLimit }}</mat-toolbar>

<mat-tab-group>
  <mat-tab label="Game">
    <mat-grid-list cols="2" rowHeight="3:1" role="list">
      <mat-grid-tile *ngFor="let p of game.players" role="listitem" [ngClass]="{ activePlayer: game.currentPlayer === p, onTwoFouls: game.getPlayerStatsByPlayer(p).consecutiveFouls == 2 }">
        <div style="text-align: center">
          <div style="text-align: center">{{ p.name }}</div>
          <div style="font-size: 20pt">{{ game.getPlayerStatsByPlayer(p).score }}</div>
        </div>
      </mat-grid-tile>
    </mat-grid-list>
    <form *ngIf="!game.hasWinner">
      <mat-grid-list cols="5" rowHeight="1:1">
        <!--TODO: Restore 15th ball option -->
        <!-- <mat-grid-tile><button type="button" mat-button (click)="newRack(0)">0</button></mat-grid-tile>-->
        <mat-grid-tile>
          <button type="button" mat-mini-fab (click)="newRack(1)">1</button>
        </mat-grid-tile>
        <mat-grid-tile *ngFor="let i of [2,3,4,5,6,7,8,9,10,11,12,13,14,15]">
          <button type="button" mat-mini-fab name="balls{{i}}" (click)="ballsRemaining = i" [color]="ballsRemaining == i ? 'primary' : 'accent'"
            [disabled]="game.ballsRemaining < i">{{i}}</button>
        </mat-grid-tile>
      </mat-grid-list>
      <div class="actionButtons">
        <table style="margin-left:auto;margin-right:auto;">
          <tr>
            <td>
              <button mat-raised-button type="button" color="warn" (click)="foul()">Foul</button>
            </td>
            <td>
              <button mat-raised-button type="button" color="primary" (click)="miss()">Miss</button>
            </td>
            <td>
              <button mat-raised-button type="button" color="accent" (click)="safety()">Safety</button>
            </td>
          </tr>
          <tr>
            <td>
              <button mat-stroked-button type="button" color="warn" *ngIf="game.isOpeningBreak && ballsRemaining === 15" id="breakingFoul"
                (click)="breakingFoul()">Breaking</button>
            </td>
            <td>
              <button mat-icon-button type="button" color="primary" *ngIf="game.canUndo" (click)="game.undo()">
                <mat-icon>undo</mat-icon>
              </button>
            </td>
            <td>
              <button mat-stroked-button type="button" color="accent" *ngIf="game.canSwitchPlayers && ballsRemaining === 15" id="switchPlayers"
                (click)="game.switchPlayers()">Switch</button>
              <button mat-stroked-button type="button" color="accent" *ngIf="game.canForceRerack && ballsRemaining === 15" id="forceRerack"
                (click)="endTurn('ForceRerack')">Re-rack</button>
            </td>
          </tr>
        </table>
      </div>
    </form>
  </mat-tab>
  <mat-tab label="Stats">
    <app-players [game]="game"></app-players>
  </mat-tab>
  <mat-tab label="Details">
      <table mat-table dense [dataSource]="obsTurns" width="100%">
          <!--- Note that these columns can be defined in any order.
                The actual rendered columns are set as a property on the row definition" -->

          <ng-container matColumnDef="ballsMade">
              <th mat-header-cell *matHeaderCellDef>Balls Made</th>
              <td mat-cell *matCellDef="let element">{{ element.totalBallsMade }}</td>
          </ng-container>

          <ng-container matColumnDef="ending">
              <th mat-header-cell *matHeaderCellDef>Ending</th>
              <td mat-cell *matCellDef="let element">{{ element.ending }}</td>
          </ng-container>

          <ng-container matColumnDef="points">
              <th mat-header-cell *matHeaderCellDef>Points</th>
              <td mat-cell *matCellDef="let element">{{ element.totalPoints }}</td>
          </ng-container>

          <ng-container matColumnDef="player">
              <th mat-header-cell *matHeaderCellDef>Player</th>
              <td mat-cell *matCellDef="let element">{{ element.playerIndex }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['player', 'ballsMade', 'ending', 'points']; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: ['player', 'ballsMade', 'ending', 'points'];"></tr>
      </table>
    </mat-tab>
</mat-tab-group>
